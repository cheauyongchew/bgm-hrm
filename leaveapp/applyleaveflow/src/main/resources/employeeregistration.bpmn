<?xml version="1.0" encoding="UTF-8"?> 
<definitions id="Definition"
             targetNamespace="http://www.jboss.org/drools"
             typeLanguage="http://www.java.com/javaTypes"
             expressionLanguage="http://www.mvel.org/2.0"
             xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd"
             xmlns:g="http://www.jboss.org/drools/flow/gpd"
             xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
             xmlns:tns="http://www.jboss.org/drools">

  <itemDefinition id="ItemDefinition_1" structureRef="String" />
  <itemDefinition id="ItemDefinition_2" structureRef="Integer" />
  <itemDefinition id="ItemDefinition_3" structureRef="Boolean" />
  <itemDefinition id="_ItemDefinition_3" structureRef="com.beans.leaveapp.employee.model.RegisteredEmployee" />
  <itemDefinition id="_joinDate" structureRef="java.util.Date" />

  <process processType="Private" isExecutable="true" id="com.beans.leaveapp.bpmn.empreg" name="Employee Registration" tns:packageName="defaultPackage" tns:version="1" >

    <extensionElements>
     <tns:import name="com.beans.leaveapp.employee.model.RegisteredEmployee" />
     <tns:import name="com.beans.leaveapp.employee.service.EmployeeRegistrationWorker" />
    </extensionElements>
    <!-- process variables -->
    <property id="username" itemSubjectRef="ItemDefinition_1"/>
    <property id="password" itemSubjectRef="ItemDefinition_1"/>
    <property id="fullname" itemSubjectRef="ItemDefinition_1"/>
    <property id="personalEmailAddress" itemSubjectRef="ItemDefinition_1"/>
    <property id="personalPhoneNumber" itemSubjectRef="ItemDefinition_1"/>
    <property id="gender" itemSubjectRef="ItemDefinition_1"/>
    <property id="idNumber" itemSubjectRef="ItemDefinition_1"/>
    <property id="passportNumber" itemSubjectRef="ItemDefinition_1"/>
    <property id="position" itemSubjectRef="ItemDefinition_1"/>
    <property id="departmentId" itemSubjectRef="ItemDefinition_2"/>
    <property id="employeeTypeId" itemSubjectRef="ItemDefinition_2"/>
    <property id="employeeGradeId" itemSubjectRef="ItemDefinition_2"/>
    <property id="isApproved" itemSubjectRef="ItemDefinition_3"/>
    <property id="workEmailAddress" itemSubjectRef="ItemDefinition_1"/>
    <property id="workPhoneNumber" itemSubjectRef="ItemDefinition_1"/>
    <property id="reason" itemSubjectRef="ItemDefinition_1"/>
    <property id="employeeNumber" itemSubjectRef="ItemDefinition_1"/>
    <property id="registeredEmployee" itemSubjectRef="_ItemDefinition_3"/>
    <property id="joinDate" itemSubjectRef="null"/>

    <!-- nodes -->
    <startEvent id="_1" name=""  isInterrupting="true"/>
    <userTask id="UserTask_1" name="HR Approval" >
      <ioSpecification>
        <dataInput id="UserTask_1_positionInput" name="position" />
        <dataInput id="UserTask_1_employeeTypeIdInput" name="employeeTypeId" />
        <dataInput id="UserTask_1_reasonInput" name="reason" />
        <dataInput id="UserTask_1_personalEmailAddressInput" name="personalEmailAddress" />
        <dataInput id="UserTask_1_personalPhoneNumberInput" name="personalPhoneNumber" />
        <dataInput id="UserTask_1_passportNumberInput" name="passportNumber" />
        <dataInput id="UserTask_1_workPhoneNumberInput" name="workPhoneNumber" />
        <dataInput id="UserTask_1_workEmailAddressInput" name="workEmailAddress" />
        <dataInput id="UserTask_1_passwordInput" name="password" />
        <dataInput id="UserTask_1_joinDateInput" name="joinDate" />
        <dataInput id="UserTask_1_usernameInput" name="username" />
        <dataInput id="UserTask_1_genderInput" name="gender" />
        <dataInput id="UserTask_1_isApprovedInput" name="isApproved" />
        <dataInput id="UserTask_1_departmentIdInput" name="departmentId" />
        <dataInput id="UserTask_1_employeeGradeIdInput" name="employeeGradeId" />
        <dataInput id="UserTask_1_registeredEmployeeInput" name="registeredEmployee" />
        <dataInput id="UserTask_1_fullnameInput" name="fullname" />
        <dataInput id="UserTask_1_idNumberInput" name="idNumber" />
        <dataInput id="UserTask_1_GroupIdInput" name="GroupId" />
        <dataInput id="UserTask_1_NodeNameInput" name="NodeName" />
        <dataOutput id="UserTask_1_positionOutput" name="position" />
        <dataOutput id="UserTask_1_employeeTypeIdOutput" name="employeeTypeId" />
        <dataOutput id="UserTask_1_reasonOutput" name="reason" />
        <dataOutput id="UserTask_1_personalEmailAddressOutput" name="personalEmailAddress" />
        <dataOutput id="UserTask_1_personalPhoneNumberOutput" name="personalPhoneNumber" />
        <dataOutput id="UserTask_1_workPhoneNumberOutput" name="workPhoneNumber" />
        <dataOutput id="UserTask_1_passportNumberOutput" name="passportNumber" />
        <dataOutput id="UserTask_1_workEmailAddressOutput" name="workEmailAddress" />
        <dataOutput id="UserTask_1_joinDateOutput" name="joinDate" />
        <dataOutput id="UserTask_1_genderOutput" name="gender" />
        <dataOutput id="UserTask_1_departmentIdOutput" name="departmentId" />
        <dataOutput id="UserTask_1_isApprovedOutput" name="isApproved" />
        <dataOutput id="UserTask_1_employeeGradeIdOutput" name="employeeGradeId" />
        <dataOutput id="UserTask_1_employeeNumberOutput" name="employeeNumber" />
        <dataOutput id="UserTask_1_registeredEmployeeOutput" name="registeredEmployee" />
        <dataOutput id="UserTask_1_fullnameOutput" name="fullname" />
        <dataOutput id="UserTask_1_idNumberOutput" name="idNumber" />
        <inputSet>
          <dataInputRefs>UserTask_1_positionInput</dataInputRefs>
          <dataInputRefs>UserTask_1_employeeTypeIdInput</dataInputRefs>
          <dataInputRefs>UserTask_1_reasonInput</dataInputRefs>
          <dataInputRefs>UserTask_1_personalEmailAddressInput</dataInputRefs>
          <dataInputRefs>UserTask_1_personalPhoneNumberInput</dataInputRefs>
          <dataInputRefs>UserTask_1_passportNumberInput</dataInputRefs>
          <dataInputRefs>UserTask_1_workPhoneNumberInput</dataInputRefs>
          <dataInputRefs>UserTask_1_workEmailAddressInput</dataInputRefs>
          <dataInputRefs>UserTask_1_passwordInput</dataInputRefs>
          <dataInputRefs>UserTask_1_joinDateInput</dataInputRefs>
          <dataInputRefs>UserTask_1_usernameInput</dataInputRefs>
          <dataInputRefs>UserTask_1_genderInput</dataInputRefs>
          <dataInputRefs>UserTask_1_isApprovedInput</dataInputRefs>
          <dataInputRefs>UserTask_1_departmentIdInput</dataInputRefs>
          <dataInputRefs>UserTask_1_employeeGradeIdInput</dataInputRefs>
          <dataInputRefs>UserTask_1_registeredEmployeeInput</dataInputRefs>
          <dataInputRefs>UserTask_1_fullnameInput</dataInputRefs>
          <dataInputRefs>UserTask_1_idNumberInput</dataInputRefs>
          <dataInputRefs>UserTask_1_GroupIdInput</dataInputRefs>
          <dataInputRefs>UserTask_1_NodeNameInput</dataInputRefs>
        </inputSet>
        <outputSet>
          <dataOutputRefs>UserTask_1_positionOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_employeeTypeIdOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_reasonOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_personalEmailAddressOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_personalPhoneNumberOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_workPhoneNumberOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_passportNumberOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_workEmailAddressOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_joinDateOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_genderOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_departmentIdOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_isApprovedOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_employeeGradeIdOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_employeeNumberOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_registeredEmployeeOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_fullnameOutput</dataOutputRefs>
          <dataOutputRefs>UserTask_1_idNumberOutput</dataOutputRefs>
        </outputSet>
      </ioSpecification>
      <dataInputAssociation>
        <sourceRef>position</sourceRef>
        <targetRef>UserTask_1_positionInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>employeeTypeId</sourceRef>
        <targetRef>UserTask_1_employeeTypeIdInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>reason</sourceRef>
        <targetRef>UserTask_1_reasonInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>personalEmailAddress</sourceRef>
        <targetRef>UserTask_1_personalEmailAddressInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>personalPhoneNumber</sourceRef>
        <targetRef>UserTask_1_personalPhoneNumberInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>passportNumber</sourceRef>
        <targetRef>UserTask_1_passportNumberInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>workPhoneNumber</sourceRef>
        <targetRef>UserTask_1_workPhoneNumberInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>workEmailAddress</sourceRef>
        <targetRef>UserTask_1_workEmailAddressInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>password</sourceRef>
        <targetRef>UserTask_1_passwordInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>joinDate</sourceRef>
        <targetRef>UserTask_1_joinDateInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>username</sourceRef>
        <targetRef>UserTask_1_usernameInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>gender</sourceRef>
        <targetRef>UserTask_1_genderInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>isApproved</sourceRef>
        <targetRef>UserTask_1_isApprovedInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>departmentId</sourceRef>
        <targetRef>UserTask_1_departmentIdInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>employeeGradeId</sourceRef>
        <targetRef>UserTask_1_employeeGradeIdInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>registeredEmployee</sourceRef>
        <targetRef>UserTask_1_registeredEmployeeInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>fullname</sourceRef>
        <targetRef>UserTask_1_fullnameInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <sourceRef>idNumber</sourceRef>
        <targetRef>UserTask_1_idNumberInput</targetRef>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>UserTask_1_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">ROLE_HR</from>
          <to xsi:type="tFormalExpression">UserTask_1_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>UserTask_1_NodeNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">HR Approval</from>
          <to xsi:type="tFormalExpression">UserTask_1_NodeNameInput</to>
        </assignment>
      </dataInputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_positionOutput</sourceRef>
        <targetRef>position</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_employeeTypeIdOutput</sourceRef>
        <targetRef>employeeTypeId</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_reasonOutput</sourceRef>
        <targetRef>reason</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_personalEmailAddressOutput</sourceRef>
        <targetRef>personalEmailAddress</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_personalPhoneNumberOutput</sourceRef>
        <targetRef>personalPhoneNumber</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_workPhoneNumberOutput</sourceRef>
        <targetRef>workPhoneNumber</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_passportNumberOutput</sourceRef>
        <targetRef>passportNumber</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_workEmailAddressOutput</sourceRef>
        <targetRef>workEmailAddress</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_joinDateOutput</sourceRef>
        <targetRef>joinDate</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_genderOutput</sourceRef>
        <targetRef>gender</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_departmentIdOutput</sourceRef>
        <targetRef>departmentId</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_isApprovedOutput</sourceRef>
        <targetRef>isApproved</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_employeeGradeIdOutput</sourceRef>
        <targetRef>employeeGradeId</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_employeeNumberOutput</sourceRef>
        <targetRef>employeeNumber</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_registeredEmployeeOutput</sourceRef>
        <targetRef>registeredEmployee</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_fullnameOutput</sourceRef>
        <targetRef>fullname</targetRef>
      </dataOutputAssociation>
      <dataOutputAssociation>
        <sourceRef>UserTask_1_idNumberOutput</sourceRef>
        <targetRef>idNumber</targetRef>
      </dataOutputAssociation>
    </userTask>
    <endEvent id="EndEvent_1" name="" />
    <exclusiveGateway id="ExclusiveGateway_1" name="" gatewayDirection="Diverging" />
    <scriptTask id="ScriptTask_1" name="Send Reject Email" scriptFormat="http://www.java.com/java" >
      <script>System.out.println("Reject");</script>
    </scriptTask>
    <scriptTask id="ScriptTask_2" name="Save Employee" scriptFormat="http://www.java.com/java" >
      <script>EmployeeRegistrationWorker.registerEmployee(registeredEmployee);</script>
    </scriptTask>
    <endEvent id="EndEvent_3" name="" />

    <!-- connections -->
    <sequenceFlow id="_1-UserTask_1" sourceRef="_1" targetRef="UserTask_1" />
    <sequenceFlow id="ScriptTask_2-EndEvent_1" sourceRef="ScriptTask_2" targetRef="EndEvent_1" />
    <sequenceFlow id="UserTask_1-ExclusiveGateway_1" sourceRef="UserTask_1" targetRef="ExclusiveGateway_1" />
    <sequenceFlow id="ExclusiveGateway_1-ScriptTask_1" sourceRef="ExclusiveGateway_1" targetRef="ScriptTask_1" name="Not Approved" tns:priority="1" >
      <conditionExpression xsi:type="tFormalExpression" language="http://www.java.com/java" >return isApproved == false;</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="ExclusiveGateway_1-ScriptTask_2" sourceRef="ExclusiveGateway_1" targetRef="ScriptTask_2" name="Approved" tns:priority="1" >
      <conditionExpression xsi:type="tFormalExpression" language="http://www.java.com/java" >return isApproved == true;</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="ScriptTask_1-EndEvent_3" sourceRef="ScriptTask_1" targetRef="EndEvent_3" />

  </process>

  <bpmndi:BPMNDiagram>
    <bpmndi:BPMNPlane bpmnElement="com.beans.leaveapp.bpmn.empreg" >
      <bpmndi:BPMNShape bpmnElement="_1" >
        <dc:Bounds x="39" y="39" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="UserTask_1" >
        <dc:Bounds x="215" y="65" width="110" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="EndEvent_1" >
        <dc:Bounds x="446" y="66" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="ExclusiveGateway_1" >
        <dc:Bounds x="365" y="145" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="ScriptTask_1" >
        <dc:Bounds x="324" y="240" width="110" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="ScriptTask_2" >
        <dc:Bounds x="525" y="165" width="110" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="EndEvent_3" >
        <dc:Bounds x="496" y="241" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="_1-UserTask_1" >
        <di:waypoint x="63" y="63" />
        <di:waypoint x="63" y="90" />
        <di:waypoint x="270" y="90" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="ScriptTask_2-EndEvent_1" >
        <di:waypoint x="580" y="190" />
        <di:waypoint x="650" y="190" />
        <di:waypoint x="650" y="90" />
        <di:waypoint x="470" y="90" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="UserTask_1-ExclusiveGateway_1" >
        <di:waypoint x="270" y="90" />
        <di:waypoint x="390" y="90" />
        <di:waypoint x="389" y="169" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="ExclusiveGateway_1-ScriptTask_1" >
        <di:waypoint x="389" y="169" />
        <di:waypoint x="390" y="220" />
        <di:waypoint x="379" y="220" />
        <di:waypoint x="379" y="265" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="ExclusiveGateway_1-ScriptTask_2" >
        <di:waypoint x="389" y="169" />
        <di:waypoint x="514" y="170" />
        <di:waypoint x="514" y="190" />
        <di:waypoint x="580" y="190" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="ScriptTask_1-EndEvent_3" >
        <di:waypoint x="379" y="265" />
        <di:waypoint x="464" y="265" />
        <di:waypoint x="464" y="265" />
        <di:waypoint x="520" y="265" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>

</definitions>